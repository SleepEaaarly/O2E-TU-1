(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a389e"],{"0338":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",[a("i-col",{attrs:{offset:"4",span:"16"}},[a("Card",[a("Row",{attrs:{type:"flex",align:"bottom"}},[a("i-col",{attrs:{span:"3"}},[a("Avatar",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.userpic}}),t.showCutter?a("avatar-cutter",{attrs:{"return-type":"file"},on:{cancel:function(e){t.showCutter=!1},enter:t.handleUploadAvatar}}):t._e()],1),a("i-col",{staticStyle:{height:"120px"},attrs:{span:"5"}},[a("div",{staticClass:"user-name"},[t._v("\n              "+t._s(""===t.nickName?t.userName:t.nickName)+"\n            ")]),a("p",{staticStyle:{"margin-top":"5px"}},[t._v(" 邮箱: "+t._s(t.userEmail)+" ")]),a("p",[t._v(" 所属组织: "+t._s(t.userCompany)+" ")])]),a("i-col",{staticStyle:{height:"40px","text-align":"center"},attrs:{offset:"10",span:"2"}},[a("p",{staticClass:"data-title"},[t._v(" 总发布数 ")]),a("p",[t._v(" "+t._s(t.totalPub)+" ")])]),a("i-col",{staticStyle:{height:"40px","text-align":"center"},attrs:{span:"2"}},[a("p",{staticClass:"data-title"},[t._v(" 总粉丝数 ")]),a("p",[t._v(" "+t._s(t.totalFollow)+" ")])]),a("i-col",{staticStyle:{height:"40px","text-align":"center"},attrs:{span:"2"}},[a("p",{staticClass:"data-title"},[t._v(" 总点赞数 ")]),a("p",[t._v(" "+t._s(t.totalLike)+" ")])])],1)],1)],1)],1),a("br"),a("Row",[a("i-col",{attrs:{offset:"4",span:"16"}},[a("Card",[a("Tabs",{on:{"on-click":t.changeTab},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[a("TabPane",{attrs:{label:t.postText,name:"myPost"}},[t.isSponsor?a("Select",{staticStyle:{"margin-bottom":"20px",width:"auto",alian:"right"},attrs:{value:"knowledge"},on:{"on-change":t.changePostType},model:{value:t.postSelectType,callback:function(e){t.postSelectType=e},expression:"postSelectType"}},[a("Option",{attrs:{label:"论文解读",value:"论文解读"}},[t._v("论文解读")])],1):t._e(),0!==t.data.length?[t.loading?a("Row",[a("i-col",{staticClass:"demo-spin-col",attrs:{offset:"8",span:"8"}},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),a("div",[t._v("Loading")])],1)],1)],1):t._l(t.data,(function(e){return a("div",{key:e.id},[a("Row",[a("i-col",{attrs:{span:"4"}},[t._v("\n                    "+t._s(1===e.type?"论文解读":"批注")+":\n                  ")]),a("i-col",{staticClass:"post-content",attrs:{span:"7"}},[a("editor",{domProps:{innerHTML:t._s(e.content)}})],1),a("i-col",{staticStyle:{"text-align":"center"},attrs:{offset:"1",span:"2"}},[a("p",{staticClass:"data-title"},[t._v(" 点赞数: ")]),t._v(" "+t._s(e.like_num)+"\n                  ")]),a("i-col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}},[a("p",{staticClass:"data-title"},[t._v(" 收藏数: ")]),t._v(" "+t._s(e.favor_num)+"\n                  ")]),t.isOther?a("i-col",{attrs:{offset:"5",span:"2"}},[a("i-button",{staticStyle:{width:"70px"},attrs:{type:"info"},on:{click:function(a){return t.handleShow(e.id,e.type)}}},[t._v("\n                      查看\n                    ")])],1):a("i-col",{attrs:{offset:"1",span:"7"}},[a("i-button",{staticStyle:{width:"70px"},attrs:{type:"info"},on:{click:function(a){return t.handleShow(e.id,e.type)}}},[t._v("\n                      查看\n                    ")]),t._v("\n                     \n                    "),a("i-button",{staticStyle:{width:"70px"},attrs:{type:"info"},on:{click:function(a){return t.handleModifyPost(e.id,e.type)}}},[t._v("\n                      修改\n                    ")]),t._v("\n                     \n                    "),a("i-button",{staticStyle:{width:"70px"},attrs:{type:"info"},on:{click:function(a){return t.handleDelete(e.id,e.type)}}},[t._v("\n                      删除\n                    ")])],1)],1),a("Divider")],1)})),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.totalCnt,"page-size":t.pageSize,current:t.pageIndex,"show-total":""},on:{"on-change":t.changePage}})],1),a("Modal",{attrs:{"footer-hide":"",width:"720"},model:{value:t.showDetail,callback:function(e){t.showDetail=e},expression:"showDetail"}},[t.showDetail?a("PaperCard",t._b({},"PaperCard",t.post,!1)):t._e()],1),a("Modal",{attrs:{width:"800",title:"修改"},on:{"on-ok":function(e){return t.handleSubmit("interpretation")}},model:{value:t.showModify,callback:function(e){t.showModify=e},expression:"showModify"}},[1===t.postType?a("i-form",{ref:"interpretationForm",attrs:{model:t.post,"label-width":120}},[a("form-item",{attrs:{label:"标题",prop:"title"}},[a("i-input",{attrs:{type:"text",placeholder:"请输入标题"},model:{value:t.post.title,callback:function(e){t.$set(t.post,"title",e)},expression:"post.title"}})],1),a("form-item",{attrs:{label:"内容",prop:"content",isRealtime:"true",cache:!1}},[a("editor",{ref:"editor1",attrs:{id:"editor1",isRealtime:"true"},model:{value:t.post.content,callback:function(e){t.$set(t.post,"content",e)},expression:"post.content"}})],1),a("form-item",{attrs:{label:"解读对象",prop:"citation"}},[a("i-input",{attrs:{type:"text",placeholder:"请输入参考文献(GB7714格式)"},model:{value:t.post.citation,callback:function(e){t.$set(t.post,"citation",e)},expression:"post.citation"}})],1),a("form-item",{attrs:{label:"解读对象链接",prop:"source"}},[a("i-input",{attrs:{type:"text",placeholder:"请输入链接"},model:{value:t.post.source,callback:function(e){t.$set(t.post,"source",e)},expression:"post.source"}})],1),a("form-item",{attrs:{label:"解读对象年份",prop:"publishedYear"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.post.publishedYear,expression:"post.publishedYear"}],attrs:{type:"number"},domProps:{value:t.post.publishedYear},on:{input:function(e){e.target.composing||t.$set(t.post,"publishedYear",e.target.value)}}})])],1):a("i-form",{ref:"conjectureForm",attrs:{rules:t.conjectureRule,model:t.post,"label-width":120}},[a("form-item",{attrs:{label:"内容",prop:"content"}},[a("i-input",{attrs:{type:"textarea",placeholder:"内容不超过200字",maxlength:200,rows:4},model:{value:t.post.content,callback:function(e){t.$set(t.post,"content",e)},expression:"post.content"}})],1)],1)],1)]:[a("div",{staticStyle:{"text-align":"center","font-size":"20px"}},[t._v("\n                暂无发布\n              ")])]],2),a("TabPane",{attrs:{label:t.favorText,name:"myFavor"}},[0!==t.data.length?[t.loading?a("Row",[a("i-col",{staticClass:"demo-spin-col",attrs:{offset:"8",span:"8"}},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),a("div",[t._v("Loading")])],1)],1)],1):t._l(t.data,(function(e){return a("div",{key:e.id},[a("Row",[a("i-col",{attrs:{span:"4"}},[t._v("\n                    "+t._s("论文解读:")+"\n                  ")]),a("i-col",{staticClass:"post-content",attrs:{span:"8"}},[a("editor",{domProps:{innerHTML:t._s(e.title)}})],1),a("i-col",{attrs:{offset:"9",span:"2"}},[a("i-button",{staticStyle:{width:"70px"},attrs:{type:"info"},on:{click:function(a){return t.handleShow(e.id,e.type)}}},[t._v("\n                      查看\n                    ")])],1)],1),a("Divider")],1)})),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.totalCnt,"page-size":t.pageSize,current:t.pageIndex},on:{"on-change":t.changePage}})],1)]:t.loading?a("Row",[a("i-col",{staticClass:"demo-spin-col",attrs:{offset:"8",span:"8"}},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),a("div",[t._v("Loading")])],1)],1)],1):[a("div",{staticStyle:{"text-align":"center","font-size":"20px"}},[t._v("\n                暂无收藏\n              ")])]],2),a("TabPane",{attrs:{label:"关注列表",name:"followBack"}},[0!==t.data.length?[t.loading?a("Row",[a("i-col",{staticClass:"demo-spin-col",attrs:{offset:"8",span:"8"}},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),a("div",[t._v("Loading")])],1)],1)],1):t._l(t.data,(function(e){return a("div",{key:e.id},[a("Row",[a("i-col",{attrs:{span:"2"}},[a("Avatar",{staticStyle:{width:"100%",height:"100%"},attrs:{src:["http://116.63.14.146:8000/api/"+e.icon]}})],1),a("i-col",{attrs:{span:"5"}},[a("div",{staticClass:"user-name"},[t._v("\n                      "+t._s(e.username)+"\n                    ")]),a("p",{staticStyle:{"margin-top":"5px"}},[t._v(" 邮箱: "+t._s(e.email||"暂无邮箱信息")+" ")]),a("p",[t._v(" 所属组织: "+t._s(e.institution||"暂无组织信息")+" ")])]),t.isOther?a("i-col",{attrs:{offset:"13",span:"3"}},[a("i-button",{staticStyle:{width:"100px",height:"35px",top:"31px",position:"relative"},attrs:{type:"primary"},on:{click:function(a){return t.jumpUserInfo(e.id)}}},[t._v("\n                      他的主页\n                    ")])],1):a("i-col",{attrs:{offset:"8",span:"8"}},[a("i-button",{staticStyle:{width:"40%",height:"35px",top:"31px",position:"relative"},attrs:{type:"primary"},on:{click:function(a){return t.jumpUserInfo(e.id)}}},[t._v("\n                      他的主页\n                    ")]),t._v("\n                      \n                    "),a("i-button",{staticStyle:{width:"40%",height:"35px",top:"31px",position:"relative"},attrs:{type:"primary"},on:{click:function(a){return t.handleUnFollow(e.id)}}},[t._v("\n                      取消关注\n                    ")])],1)],1),a("Divider")],1)})),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.totalCnt,"page-size":t.pageSize,current:t.pageIndex,"show-total":""},on:{"on-change":t.changePage}})],1)]:t.loading?a("Row",[a("i-col",{staticClass:"demo-spin-col",attrs:{offset:"8",span:"8"}},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),a("div",[t._v("Loading")])],1)],1)],1):[a("div",{staticStyle:{"text-align":"center","font-size":"20px"}},[t._v("\n                当前暂无关注\n              ")])]],2),a("TabPane",{attrs:{label:"粉丝列表",name:"fan"}},[0!==t.data.length?[t.loading?a("Row",[a("i-col",{staticClass:"demo-spin-col",attrs:{offset:"8",span:"8"}},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),a("div",[t._v("Loading")])],1)],1)],1):t._l(t.data,(function(e){return a("div",{key:e.id},[a("Row",[a("i-col",{attrs:{span:"2"}},[a("Avatar",{staticStyle:{width:"100%",height:"100%"},attrs:{src:["http://116.63.14.146:8000/api/"+e.icon]}})],1),a("i-col",{attrs:{span:"5"}},[a("div",{staticClass:"user-name"},[t._v("\n                      "+t._s(e.username)+"\n                    ")]),a("p",{staticStyle:{"margin-top":"5px"}},[t._v(" 邮箱: "+t._s(e.email||"暂无邮箱信息")+" ")]),a("p",[t._v(" 所属组织: "+t._s(e.institution||"暂无组织信息")+" ")])]),a("i-col",{attrs:{offset:"11",span:"4"}},[a("i-button",{staticStyle:{width:"100px",height:"35px",top:"31px",position:"relative"},attrs:{type:"primary"},on:{click:function(a){return t.jumpUserInfo(e.id)}}},[t._v("\n                      他的主页\n                    ")])],1)],1),a("Divider")],1)})),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.totalCnt,"page-size":t.pageSize,current:t.pageIndex,"show-total":""},on:{"on-change":t.changePage}})],1)]:t.loading?a("Row",[a("i-col",{staticClass:"demo-spin-col",attrs:{offset:"8",span:"8"}},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),a("div",[t._v("Loading")])],1)],1)],1):[a("div",{staticStyle:{"text-align":"center","font-size":"20px"}},[t._v("\n                当前暂无粉丝\n              ")])]],2),t.isOther?t._e():a("TabPane",{staticStyle:{margin:"0px"},attrs:{label:"修改资料",name:"modify"}},[a("Divider",[t._v("\n              更改组织\n            ")]),a("Row",[a("i-col",{attrs:{offset:"7",span:"8"}},[a("i-form",{ref:"modifyOrg",staticStyle:{margin:"0px"},attrs:{model:t.modifyOrg,rules:t.modifyOrgRule,"label-width":120}},[a("form-item",{attrs:{label:"组织",prop:"newOrg"}},[a("i-input",{model:{value:t.modifyOrg.newOrg,callback:function(e){t.$set(t.modifyOrg,"newOrg",e)},expression:"modifyOrg.newOrg"}})],1),a("form-item",[a("i-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("modifyOrg")}}},[t._v("\n                      确认修改\n                    ")])],1)],1)],1)],1),a("Divider",[t._v("\n              重置密码\n            ")]),a("Row",[a("i-col",{attrs:{offset:"7",span:"8"}},[a("i-form",{ref:"modifyPassword",staticStyle:{margin:"0px"},attrs:{model:t.modifyPassword,rules:t.modifyPassRule,"label-width":120}},[a("form-item",{attrs:{label:"输入旧密码",prop:"oldPassword"}},[a("i-input",{attrs:{type:"password"},model:{value:t.modifyPassword.oldPassword,callback:function(e){t.$set(t.modifyPassword,"oldPassword",e)},expression:"modifyPassword.oldPassword"}})],1),a("form-item",{attrs:{label:"输入新密码",prop:"newPassword1"}},[a("i-input",{attrs:{type:"password"},model:{value:t.modifyPassword.newPassword1,callback:function(e){t.$set(t.modifyPassword,"newPassword1",e)},expression:"modifyPassword.newPassword1"}})],1),a("form-item",{attrs:{label:"确认新密码",prop:"newPassword2"}},[a("i-input",{attrs:{type:"password"},model:{value:t.modifyPassword.newPassword2,callback:function(e){t.$set(t.modifyPassword,"newPassword2",e)},expression:"modifyPassword.newPassword2"}})],1),a("form-item",[a("i-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("modifyPassword")}}},[t._v("\n                      确认修改\n                    ")])],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)},i=[],n=(a("7f7f"),a("96cf"),a("3b8d")),s=(a("a481"),a("c24f")),r=a("c276"),l=a("24d2"),c=a("6c49"),d=a("8700"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"c-avatar-cutter",on:{dragstart:!1}},[a("div",{staticClass:"mask"}),a("div",{staticClass:"container g-popup-box"},[a("p",{staticClass:"title"},[t._v("选择头像")]),a("div",{staticClass:"content"},[a("div",{staticClass:"c-left",class:{"c-left--doing":t.imgURL}},[a("div",{staticClass:"container-box",style:{width:t.containerBoxData.width+"px",height:t.containerBoxData.height+"px"}},[a("img",{ref:"$img",attrs:{src:t.imgURL}}),a("div",{staticClass:"img-mask"}),t.imgURL?a("div",{staticClass:"select-box",style:{top:t.selectData.top+"px",left:t.selectData.left+"px",width:t.selectData.width+"px",height:t.selectData.width+"px","background-image":"url("+t.imgURL+")","background-position":-t.selectData.left+"px "+-t.selectData.top+"px","background-size":t.containerBoxData.width+"px "+t.containerBoxData.height+"px"},on:{mousedown:function(e){return t.onMouseDown(e,"move")}}},[a("ul",{staticClass:"x-line"},[a("li",{on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown(e,"stretch","top")}}}),a("li"),a("li"),a("li",{on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown(e,"stretch","bottom")}}})]),a("ul",{staticClass:"y-line"},[a("li",{on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown(e,"stretch","left")}}}),a("li"),a("li"),a("li",{on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown(e,"stretch","right")}}})]),a("ul",{staticClass:"point"},[a("li",{on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown(e,"stretch","top-left")}}}),a("li",{on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown(e,"stretch","top-right")}}}),a("li",{on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown(e,"stretch","bottom-left")}}}),a("li",{on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown(e,"stretch","bottom-right")}}})]),a("div",{staticClass:"cross"})]):t._e()])]),a("div",{staticClass:"c-right"},[a("div",{staticClass:"preview"},[a("p",[t._v("预览")]),a("canvas",{ref:"$canvas",class:{"canvas--doing":t.imgURL},attrs:{width:"190",height:"190"}},[t._v(">")])]),a("Upload",{staticStyle:{"margin-top":"20px"},attrs:{"before-upload":t.handleUpload,action:"//jsonplaceholder.typicode.com/posts/",accept:"image/*",format:["jpg","jpeg","png"]}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.imgURL?"重新上传":"上传图片"))])],1)],1)]),a("div",{staticClass:"c-btn-group"},[a("input",{staticClass:"btn-cancel",attrs:{type:"button",value:"取消"},on:{click:t.onCancel}}),a("input",{staticClass:"btn-enter",class:{"btn-enter--disable":!t.imgURL},attrs:{type:"button",value:"确定"},on:{click:t.onEnter}})])])])},u=[],h=(a("34ef"),a("4917"),a("28a5"),{props:{returnType:{type:String,default:"url"}},data:function(){return{imgURL:"",scaleRate:1,minWidth:20,containerBoxData:{width:0,height:0},selectData:{top:0,left:0,width:0,action:"",originPoint:{},selectLine:""}}},created:function(){document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove)},beforeDestroy:function(){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove)},methods:{getImgSize:function(t){return new Promise((function(e){var a=document.createElement("img");a.src=t,a.style.opacity=0,a.addEventListener("error",(function(){document.body.removeChild(a),e(!1)})),a.addEventListener("load",(function(){var t={width:a.naturalWidth,height:a.naturalHeight};document.body.removeChild(a),e(t)})),document.body.appendChild(a)}))},base64ToFile:function(t,e){var a=t.split(","),o=a[0].match(/:(.*?)/)[1],i=atob(a[1]),n=i.length,s=new Uint8Array(n);while(n)n-=1,s[n]=i.charCodeAt(n);return new File([s],e,{type:o})},getCamelCase:function(t){return t.replace(/-[a-z]+?/g,(function(t){return t[1].toUpperCase()}))},getWord:function(t){return t[0].toUpperCase()+t.substr(1)},onMouseDown:function(t,e,a){var o=this.selectData;o.action=e,o.direction=a||"",o.originPoint={x:t.clientX>0?t.clientX:0,y:t.clientY>0?t.clientY:0}},onMouseUp:function(){var t=this.selectData;t.action="",t.direction=""},onMouseMove:function(t){var e=this.selectData,a=this.containerBoxData,o=e.originPoint,i=o.x,n=o.y,s=t.clientX-i,r=t.clientY-n;if("move"===e.action)this.doMove(e,a,s,r);else{if("stretch"!==e.action)return;this.doStretch(e,a,s,r)}e.originPoint={x:t.clientX>0?t.clientX:0,y:t.clientY>0?t.clientY:0},this.setPreview()},doMove:function(t,e,a,o){t.top+=o,t.left+=a,t.top<0&&(t.top=0),t.left<0&&(t.left=0),t.top+t.width>e.height&&(t.top=e.height-t.width),t.left+t.width>e.width&&(t.left=e.width-t.width)},doStretch:function(t,e,a,o){var i=this.minWidth;function n(){var a=t.left<0?-t.left:0,o=t.top<0?-t.top:0,n=t.left+t.width>e.width?t.left+t.width-e.width:0,s=t.top+t.width>e.height?t.top+t.width-e.height:0,r=t.width<i?i-t.width:0;return Math.max(a,o,n,s,r)}function s(e){var o=a;o="preDo"===e?o:-o,t.top+=o/2,t.left+=o,t.width-=o}function r(e){var o=a;o="preDo"===e?o:-o,t.top-=o/2,t.width+=o}function l(e){var a=o;a="preDo"===e?a:-a,t.top+=a,t.left+=a/2,t.width-=a}function c(e){var a=o;a="preDo"===e?a:-a,t.left-=a/2,t.width+=a}function d(e){var i=Math.abs(a)>Math.abs(o)?a:o;i="preDo"===e?i:-i,t.top+=i,t.left+=i,t.width-=i}function p(e){var i=Math.abs(a)>Math.abs(o)?a:-o;i="preDo"===e?i:-i,t.top-=i,t.width+=i}function u(e){var i=Math.abs(a)>Math.abs(o)?a:-o;i="preDo"===e?i:-i,t.left+=i,t.width-=i}function h(e){var i=Math.abs(a)>Math.abs(o)?a:o;i="preDo"===e?i:-i,t.width+=i}var f={doStretchLeft:s,doStretchRight:r,doStretchTop:l,doStretchBottom:c,doStretchTopLeft:d,doStretchTopRight:p,doStretchBottomLeft:u,doStretchBottomRight:h}["doStretch".concat(this.getWord(this.getCamelCase(t.direction)))];f("preDo");var m=n();m>0&&f("reset")},setPreview:function(){var t=this.selectData,e=this.scaleRate,a=this.$refs.$canvas.getContext("2d");a.clearRect(0,0,190,190),a.drawImage(this.$refs.$img,Math.floor(t.left/e),Math.floor(t.top/e),t.width/e,t.width/e,0,0,190,190)},fileChange:function(t){var e=this,a=t,o=new FileReader;o.onload=function(){var t=e.selectData,a=e.containerBoxData;e.imgURL=o.result,e.getImgSize(e.imgURL).then((function(o){o.width>o.height?(e.scaleRate=350/o.width,a.width=350,a.height=Math.floor(o.height*e.scaleRate),t.top=0,t.left=(350-a.height)/2,t.width=a.height):(e.scaleRate=350/o.height,a.height=350,a.width=Math.floor(o.width*e.scaleRate),t.left=0,t.top=(350-a.width)/2,t.width=a.width),e.setPreview()}))},o.readAsDataURL(a)},handleUpload:function(t){return console.log(t),this.fileChange(t),!1},onEnter:function(){this.imgURL?"url"===this.returnType?this.$emit("enter",this.$refs.$canvas.toDataURL()):"file"===this.returnType&&this.$emit("enter",this.base64ToFile(this.$refs.$canvas.toDataURL(),"avatar.png")):this.$message("请上传图片","error")},onCancel:function(){this.$emit("cancel")}}}),f=h,m=a("2877"),g=Object(m["a"])(f,p,u,!1,null,null,null),w=g.exports,v=a("dac0"),b={name:"UserInfo",components:{PaperCard:d["a"],AvatarCutter:w,editor:v["a"]},data:function(){return{loading:!0,userEmail:"xxxxxxxxx@qq.com",userCompany:"xxx研究所",userName:"xxx",isSponsor:!1,nickName:"",totalLike:102,totalFollow:10,totalPub:11,userpic:"",avatarUrl:"",isOther:!1,showDetail:!1,tabName:"myPost",modifyPassword:{oldPassword:"",newPassword1:"",newPassword2:""},modifyPassRule:{oldPassword:[{required:!0,message:"请填写旧密码",trigger:"blur"}],newPassword1:[{required:!0,message:"请填写密码",trigger:"blur"},{min:6,message:"请至少输入6位密码"}],newPassword2:[{required:!0,validator:this.validtePassWord,trigger:"blur"},{min:6,message:"请至少输入6位密码"}]},modifyEmail:{newEmail:this.userEmail},modifyOrg:{newOrg:this.userOrg},modifyEmailRule:{newEmail:[{required:!0,message:"请填写邮箱",trigger:"blur"},{validator:function(t,e,a){var o=/^([A-Za-z0-9_.])+@([A-Za-z0-9._])+\.([A-Za-z]+)$/;o.test(e)?a():a(new Error("请填写合法的邮箱"))}}]},modifyOrgRule:{newOrg:[{required:!0,message:"请填写组织",trigger:"blur"}]},pageIndex:1,pageSize:10,data:[],totalCnt:1,showCutter:!1,post:{},interpretation:{},postType:1,InterpretationeType:0,postSelectType:"论文解读",projectTotalCnt:1,projectList:[],showModify:!1,conjectureRule:{content:[{required:!0,message:"请填写内容",trigger:"blur"}]},evidenceRule:{content:[{required:!0,message:"请填写内容",trigger:"blur"}],citation:[{required:!0,message:"请填写参考文献",trigger:"blur"}],publishedYear:[{validator:function(t,e,a){e?a():a(new Error("请输入文献年份"))}}]},interpretationRule:{content:[{required:!0,message:"请填写内容",trigger:"blur"}],title:[{required:!0,message:"请填写标题",trigger:"blur"}],citation:[{required:!0,message:"请填写参考文献",trigger:"blur"}],publishedYear:[{validator:function(t,e,a){e?a():a(new Error("请输入文献年份"))}}]}}},watch:{$route:function(t,e){this.init()}},computed:{postText:function(){return this.isOther?"他的发布":"我的发布"},favorText:function(){return this.isOther?"他的收藏":"我的收藏"}},mounted:function(){var t=this;this.showModify=!0,Object(s["h"])().then((function(e){console.log(e),t.$store.commit("setUserProfile",e.data)})).catch((function(e){t.$Modal.error(Object(r["c"])(e))})),this.init(),this.showModify=!1},methods:{ToText:function(t){var e=t;return e.replace(/<(style|script|iframe)[^>]*?>[\s\S]+?<\/\1\s*>/gi,"").replace(/<[^>]+?>/g,"").replace(/\s+/g," ").replace(/ /g," ").replace(/>/g," ")},init:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.$store.state.user.userId){t.next=3;break}return t.next=3,Object(s["h"])().then((function(t){console.log(t),e.$store.commit("setUserProfile",t.data)})).catch((function(t){e.$Modal.error(Object(r["c"])(t))}));case 3:parseInt(this.$route.params.id)===parseInt(this.$store.state.user.userId)?(console.log(this.$store.state),this.isOther=!1,this.userName=this.$store.state.user.userName,this.nick_name=this.$store.state.user.nick_Name,this.userCompany=this.$store.state.user.userInstitution||"暂无组织",this.userEmail=this.$store.state.user.userEmail,this.totalLike=this.$store.state.user.userTotalLike,this.totalFollow=this.$store.state.user.userTotalFan,Object(s["h"])(this.$route.params.id).then((function(t){e.totalPub=t.data.total_post,e.userpic="http://116.63.14.146:8000/api/"+t.data.userpic,console.log(t.data.userpic)})).catch((function(t){e.$Modal.error(Object(r["c"])(t))}))):(this.isOther=!0,Object(s["h"])(this.$route.params.id).then((function(t){e.userName=t.data.username,e.nick_name=t.data.nickname,e.userCompany=t.data.institution||"暂无组织",e.userEmail=t.data.email,e.totalLike=t.data.total_like,e.totalFollow=t.data.total_fan,e.totalPub=t.data.total_post,e.userpic="http://116.63.14.146:8000/api/"+t.data.userpic})).catch((function(t){e.$Modal.error(Object(r["c"])(t))}))),this.changeTab(this.tabName);case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadFollower:function(){var t=this;this.loading=!0,Object(s["c"])(this.$route.params.id,{page:this.pageIndex,page_size:this.pageSize}).then((function(e){t.data=e.data.models,t.totalCnt=e.data.total_count,t.loading=!1})).catch((function(e){t.$Modal.error(Object(r["c"])(e))}))},loadFan:function(){var t=this;this.loading=!0,Object(s["a"])(this.$route.params.id,{page:this.pageIndex,page_size:this.pageSize}).then((function(e){t.data=e.data.models,t.totalCnt=e.data.total_count,t.loading=!1})).catch((function(e){t.$Modal.error(Object(r["c"])(e))}))},loadPost:function(){var t=this;this.loading=!0,"论文解读"===this.postSelectType?Object(s["o"])(this.$route.params.id,{page:this.pageIndex,page_size:this.pageSize}).then((function(e){t.data=e.data.models.map((function(t){return{content:t.content,favor_num:t.favor_num,like_num:t.like_num,id:t.id,type:1}})),t.totalCnt=e.data.total_count,t.loading=!1})).catch((function(e){t.$Modal.error(Object(r["c"])(e))})):this.loadProjects()},loadInterpretation:function(){var t=this;this.loading=!0,Object(s["n"])(this.$route.params.id,{page:this.pageIndex,page_size:this.pageSize}).then((function(e){t.data=e.data.models.map((function(t){return{title:t.title,content:t.content,favor_num:t.favor_num,like_num:t.like_num,id:t.id,type:0}})),t.totalCnt=e.data.total_count,t.loading=!1})).catch((function(e){t.$Modal.error(Object(r["c"])(e))}))},loadProjects:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pindex;this.loading=!0,Object(l["c"])({user_id:this.$route.params.id,psize:this.psize,pindex:e}).then((function(e){t.projectTotalCnt=e.data.page_count,t.projectList=e.data.project_list.map((function(t){return{title:t.name,id:t.id,sponsor:t.create_user.nick_name,content:t.content.replace(/&nbsp;/g,""),html:t.html_content,type:"project",timeline:t.timeline_list,modify:!0,showButton:!1,showModify:!1}})),t.loading=!1})).catch((function(t){console.log(t)}))},loadFavor:function(){var t=this;this.loading=!0,Object(c["d"])({num_per_page:this.pageSize,pindex:this.pageIndex,user_id:this.$route.params.id,interpretation:!0}).then((function(e){console.log(e),t.data=e.data.page.map((function(t){return{id:t.id,creator:t.created_by,kind:t.type-1,createAt:Object(r["e"])(t.created_at),publishedYear:t.published_year,content:t.content,tags:t.tags,isLike:t.is_like,isCollect:!0,likeNumber:t.like_num,favorNumber:t.favor_num,commentNumber:t.commentNum,displayType:0,title:t.title,source:t.source,citation:t.citation}})),t.loading=!1,t.totalCnt=e.data.total_count})).catch((function(e){t.$Modal.error(Object(r["c"])(e))}))},validtePassWord:function(t,e,a){return""===e?a(new Error("请再次输入密码")):e!==this.modifyPassword.newPassword1?a(new Error("两次密码不一致")):void a()},handleSubmit:function(t){var e=this;if("modifyPassword"===t)Object(s["m"])({"old-password":this.modifyPassword.oldPassword,"new-password":this.modifyPassword.newPassword2}).then((function(t){e.modifyPassword={oldPassword:"",newPassword1:"",newPassword2:""},e.$Message.info("成功修改")})).catch((function(t){403===t.response.data.code?e.$Message.error("旧密码错误, 请确认旧密码填写一致"):e.$Modal.error(Object(r["c"])(t))}));else if("interpretation"===t){var a={title:this.post.title,content:this.post.content,citation:this.post.citation,source:this.post.source,published_year:this.post.publishedYear};console.log(this.post.id),Object(c["a"])(this.post.id,this.postType,"put",a).then((function(t){e.$Message.info("成功修改"),e.pageIndex=1,e.loadPost()})).catch((function(t){console.log(t),e.$Modal.error(Object(r["c"])(t))}))}else"modifyEmail"===t?Object(s["k"])({"old-email":"11@qq.com","new-email":this.modifyEmail.newEmail}).then((function(t){e.modifyEmail={oldEmail:"",newEmail:""},e.$Message.info("成功修改")})).catch((function(t){e.$Modal.error(Object(r["c"])(t))})):"modifyOrg"===t&&Object(s["l"])({organization:this.modifyOrg.newOrg}).then((function(t){e.modifyOrg={oldOrg:"",newOrg:""},e.$Message.info("成功修改")})).catch((function(t){e.$Modal.error(Object(r["c"])(t))}))},changePage:function(t){this.pageIndex=t,"followBack"===this.tabName?this.loadFollower():"fan"===this.tabName?this.loadFan():"myPost"===this.tabName?this.loadPost():"myFavor"===this.tabName?this.loadFavor():"myInterpretation"===this.tabName&&this.loadInterpretation()},handleUnFollow:function(t){var e=this;Object(s["x"])(t).then((function(t){e.$Message.info("成功取消关注"),e.pageIndex=1,e.loadFollower()})).catch((function(t){e.$Modal.error(Object(r["c"])(t))}))},changeTab:function(t){this.tabName=t,this.pageIndex=1,this.data=[],"followBack"===this.tabName?this.loadFollower():"fan"===this.tabName?this.loadFan():"myPost"===this.tabName?this.loadPost():"myFavor"===this.tabName?this.loadFavor():"myInterpretation"===this.tabName&&this.loadInterpretation()},calTagColor:function(t){return 0===t?"yellow":1===t?"green":"red"},handleModifyPost:function(t,e){var a=this;Object(c["a"])(t,e,"get").then((function(o){a.post={id:t,kind:e,source:o.data.source,citation:o.data.citation,title:o.data.title,content:o.data.content,publishedYear:o.data.published_year},a.postType=e,a.showModify=!0,a.$refs.editor1.setHtml(a.post.content)}))},handleModify:function(t,e){var a=this;InterpretationeIdReq(t,e,"get").then((function(t){a.post=t.data,a.postType=e,a.showModify=!0})).catch((function(t){a.$Modal.error(Object(r["c"])(t))}))},handleDelete:function(t,e){var a=this;this.$Modal.confirm({title:"确定删除该发布",content:"请注意该操作不可逆",onOk:function(){Object(c["a"])(t,e,"delete").then((function(t){a.$Message.info("成功删除"),a.pageIndex=1,a.totalPub-=1,a.loadPost()})).catch((function(t){console.log(t),a.$Modal.error(Object(r["c"])(t))}))}})},handleProjectModify:function(t){this.$refs["project_form"][t].handleSubmit("form")},handleShow:function(t,e){var a=this;Object(c["a"])(t,e,"get").then((function(t){a.post={id:t.data.id,creator:t.data.created_by,kind:e,source:t.data.source,citation:t.data.citation,title:t.data.title,createAt:Object(r["e"])(t.data.created_at),content:t.data.content,tags:t.data.tags,isLike:t.data.is_like,isCollect:t.data.is_favor,likeNumber:t.data.like_num,favorNumber:t.data.favor_num,publishedYear:t.data.published_year,commentNumber:t.data.commentNum},a.postType=e,a.showDetail=!0})).catch((function(t){a.$Modal.error(Object(r["c"])(t))}))},jumpUserInfo:function(t){this.$router.push({name:"user_info",params:{id:t}})},handleUploadAvatar:function(t){var e={icon:t};console.log(e),Object(s["y"])(e).then((function(t){console.log(t)})).catch((function(t){console.log(t)}))},clickCutter:function(){this.showCutter=!0,console.log(this.showCutter)},changePostType:function(t){this.postSelectType=t,this.loadPost()}}},y=b,_=Object(m["a"])(y,o,i,!1,null,null,null);e["default"]=_.exports}}]);