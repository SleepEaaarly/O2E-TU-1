(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f0648288"],{b9d3:function(e,r,t){e.exports=t.p+"img/d.62b0e114.png"},e49c:function(e,r,t){"use strict";t.r(r);var s=function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("div",{staticClass:"login"},[s("div",{staticClass:"login-con"},[s("img",{attrs:{src:t("b9d3")}}),s("Card",{attrs:{icon:"log-in",bordered:!1,"dis-hover":""}},[s("div",{staticClass:"form-con"},[1===e.type?[s("login-form",{staticStyle:{margin:"0px"},attrs:{error_message:e.login_error},on:{"on-success-valid":e.handleSubmit}}),s("Button",{staticClass:"modify-pass",staticStyle:{"text-align":"center"},attrs:{type:"text"},on:{click:function(r){e.type=3}}},[e._v("忘记密码")]),3!==e.type?s("Button",{staticClass:"register",staticStyle:{"text-align":"center"},style:e.switchButtonStyle,attrs:{type:"text"},on:{click:function(r){e.type=2==e.type?1:2}}},[e._v(e._s(e.message))]):e._e()]:e._e(),2===e.type?[s("register-form",{staticStyle:{margin:"0px"},attrs:{error_message:e.register_error},on:{"on-success-valid":e.handleSubmitRegister}}),3!==e.type?s("Button",{staticClass:"register",staticStyle:{"text-align":"center"},style:e.switchButtonStyle,attrs:{type:"text"},on:{click:function(r){e.type=2==e.type?1:2}}},[e._v(e._s(e.message))]):e._e()]:e._e(),3===e.type?[s("modify-pass-form",{staticStyle:{margin:"0px"},attrs:{error_message:e.modifypass_error},on:{"on-success-valid":e.handleSubmitForgetPass}}),s("br"),s("Button",{attrs:{type:"primary",long:""},on:{click:function(r){e.type=1}}},[e._v("\n            返回\n          ")])]:e._e()],2)])],1)])},o=[],a=(t("8e6e"),t("ac6a"),t("456d"),t("386d"),t("bd86")),i=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("Form",{ref:"loginForm",attrs:{model:e.form,rules:e.rules},nativeOn:{keydown:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.handleSubmit(r)}}},[t("FormItem",{attrs:{prop:"userName"}},[t("Input",{attrs:{placeholder:"请输入用户名"},model:{value:e.form.userName,callback:function(r){e.$set(e.form,"userName",r)},expression:"form.userName"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:16,type:"ios-person"}})],1)])],1),t("FormItem",{attrs:{prop:"password"}},[t("Input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password",r)},expression:"form.password"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:14,type:"md-lock"}})],1)])],1),t("p",{staticStyle:{color:"red","text-align":"center"}},[e._v(e._s(e.error_message))]),t("FormItem",[t("Button",{attrs:{type:"primary",long:""},on:{click:e.handleSubmit}},[e._v("登录")])],1)],1)},n=[],l={name:"LoginForm",props:{userNameRules:{type:Array,default:function(){return[{required:!0,message:"用户名不能为空",trigger:"blur"}]}},passwordRules:{type:Array,default:function(){return[{required:!0,message:"密码不能为空",trigger:"blur"}]}},error_message:{type:String,default:""}},data:function(){return{form:{userName:"",password:""}}},computed:{rules:function(){return{userName:this.userNameRules,password:this.passwordRules}}},methods:{handleSubmit:function(){var e=this;this.$refs.loginForm.validate((function(r){r?e.$emit("on-success-valid",{userName:e.form.userName,password:e.form.password}):e.$Message.error("登录失败!")}))}}},c=l,m=t("2877"),u=Object(m["a"])(c,i,n,!1,null,null,null),d=u.exports,p=d,f=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("Form",{ref:"form",attrs:{model:e.form,rules:e.ruleCustom,"label-width":80}},[t("Form-item",{attrs:{label:"用户名",prop:"userName"}},[t("Input",{attrs:{type:"text",required:"true"},model:{value:e.form.userName,callback:function(r){e.$set(e.form,"userName",r)},expression:"form.userName"}})],1),t("Form-item",{attrs:{label:"密码",prop:"password"}},[t("Input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password",r)},expression:"form.password"}})],1),t("Form-item",{attrs:{label:"确认密码",prop:"passwordCheck"}},[t("Input",{attrs:{type:"password"},model:{value:e.form.passwordCheck,callback:function(r){e.$set(e.form,"passwordCheck",r)},expression:"form.passwordCheck"}})],1),t("Form-item",{attrs:{label:"邮箱",prop:"email"}},[t("Input",{attrs:{type:"email"},model:{value:e.form.email,callback:function(r){e.$set(e.form,"email",r)},expression:"form.email"}})],1),t("Form-item",{staticClass:"verify-item",attrs:{label:"验证码",prop:"verifyCode"}},[t("Input",{staticClass:"verify-input",attrs:{type:"text"},model:{value:e.form.verifyCode,callback:function(r){e.$set(e.form,"verifyCode",r)},expression:"form.verifyCode"}})],1),t("Button",{staticClass:"send-verify",attrs:{disabled:e.verifyDisabled},on:{click:e.handleSendVerify}},[e._v(e._s(e.verifyHint))]),t("p",{staticStyle:{color:"red","text-align":"center"}},[e._v(e._s(e.error_message))]),t("Button",{attrs:{type:"primary",long:""},on:{click:function(r){return e.handleSubmit("form")}}},[e._v("注册")])],1)},y=[],g=(t("7f7f"),t("4917"),t("c24f")),v={data:function(){var e=this,r=function(e,r,t){""===r?t(new Error("请输入账号")):r.length<6||r.length>16?t(new Error("账号长度应在6-16位之间")):t()},t=function(r,t,s){""===t?s(new Error("请输入密码")):t.length<6||t.length>16?s(new Error("密码长度应在6-16位之间")):(""!==e.form.passwdCheck&&e.$refs.form.validateField("passwordCheck"),s())},s=function(r,t,s){""===t?s(new Error("请再次输入密码")):t!==e.form.password?s(new Error("两次输入密码不一致!")):s()},o=function(e,r,t){""===r?t(new Error("请输入邮箱")):r.match(/[^@]+@[^@.]+\.[^@]/)?t():t(new Error("邮箱格式错误！"))};return{verifyHint:"发送验证码",verifyDisabled:!1,gap:60,timer:null,form:{userName:"",password:"",passwordCheck:"",email:"",verifyCode:""},ruleCustom:{userName:[{required:!0,validator:r,trigger:"blur"}],password:[{required:!0,validator:t,trigger:"blur"}],passwordCheck:[{required:!0,validator:s,trigger:"blur"}],email:[{required:!0,validator:o,trigger:"blur"}],verifyCode:[{required:!0,message:"请输入验证码"}]}}},props:{error_message:{type:String,default:""}},methods:{handleSubmit:function(e){var r=this;this.$refs[e].validate((function(e){e?r.$emit("on-success-valid",{userName:r.form.userName,password:r.form.password,email:r.form.email,verifyCode:r.form.verifyCode}):r.$Message.error("注册失败!")}))},handleReset:function(e){this.$refs[e].resetFields()},handleSendVerify:function(){var e=this;this.$refs.form.validateField("email"),Object(g["w"])("post",{email:this.form.email}).then((function(r){e.$Message.success("发送成功!")})).catch((function(r){console.log(r),console.log(e.form.email),e.$Message.error("邮箱已被注册!")})),this.verifyDisabled=!0,this.timer=setInterval((function(){e.gap--,e.verifyHint=e.gap+"秒",0===e.gap&&(clearInterval(e.timer),e.verifyDisabled=!1,e.verifyHint="发送验证码",e.gap=6)}),1e3)}}},h=v,w=Object(m["a"])(h,f,y,!1,null,null,null),b=w.exports,_=b,C=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("Form",{ref:"form",attrs:{model:e.form,rules:e.ruleCustom,"label-width":80}},[t("Form-item",{attrs:{label:"邮箱",prop:"email"}},[t("Input",{attrs:{type:"email"},model:{value:e.form.email,callback:function(r){e.$set(e.form,"email",r)},expression:"form.email"}})],1),t("Form-item",{staticClass:"verify-item",attrs:{label:"验证码",prop:"verifyCode"}},[t("Input",{staticClass:"verify-input",attrs:{type:"text"},model:{value:e.form.verifyCode,callback:function(r){e.$set(e.form,"verifyCode",r)},expression:"form.verifyCode"}})],1),t("Button",{staticClass:"send-verify",attrs:{disabled:e.verifyDisabled},on:{click:e.handleSendVerify}},[e._v(e._s(e.verifyHint))]),t("Form-item",{attrs:{label:"密码",prop:"password"}},[t("Input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password",r)},expression:"form.password"}})],1),t("Form-item",{attrs:{label:"确认密码",prop:"passwordCheck"}},[t("Input",{attrs:{type:"password"},model:{value:e.form.passwordCheck,callback:function(r){e.$set(e.form,"passwordCheck",r)},expression:"form.passwordCheck"}})],1),t("p",{staticStyle:{color:"red","text-align":"center"}},[e._v(e._s(e.error_message))]),t("Button",{attrs:{type:"primary",long:""},on:{click:function(r){return e.handleSubmit("form")}}},[e._v("修改密码")])],1)},k=[],$={data:function(){var e=this,r=function(r,t,s){""===t?s(new Error("请输入密码")):t.length<6||t.length>16?s(new Error("密码长度应在6-16位之间")):(""!==e.form.passwordCheck&&e.$refs.form.validateField("passwordCheck"),s())},t=function(r,t,s){""===t?s(new Error("请再次输入密码")):t!==e.form.password?s(new Error("两次输入密码不一致!")):s()},s=function(e,r,t){""===r?t(new Error("请输入邮箱")):r.match(/[^@]+@[^@.]+\.[^@]/)?t():t(new Error("邮箱格式错误！"))};return{verifyHint:"发送验证码",verifyDisabled:!1,gap:60,timer:null,form:{password:"",passwordCheck:"",email:"",verifyCode:""},ruleCustom:{password:[{required:!0,validator:r,trigger:"blur"}],passwordCheck:[{required:!0,validator:t,trigger:"blur"}],email:[{required:!0,validator:s,trigger:"blur"}],verifyCode:[{required:!0,message:"请输入验证码"}]}}},props:{error_message:{type:String,default:""}},methods:{handleSubmit:function(e){var r=this;this.$refs[e].validate((function(e){e?r.$emit("on-success-valid",{password:r.form.password,email:r.form.email,verifyCode:r.form.verifyCode}):r.$Message.error("更换密码失败!")}))},handleReset:function(e){this.$refs[e].resetFields()},handleSendVerify:function(){var e=this;this.$refs.form.validateField("email"),Object(g["u"])("post",{email:this.form.email}).then((function(r){e.$Message.success("发送成功!")})).catch((function(e){console.log(e)})),this.verifyDisabled=!0,this.timer=setInterval((function(){e.gap--,e.verifyHint=e.gap+"秒",0===e.gap&&(clearInterval(e.timer),e.verifyDisabled=!1,e.verifyHint="发送验证码",e.gap=60)}),1e3)}}},S=$,x=Object(m["a"])(S,C,k,!1,null,null,null),F=x.exports,O=F,N=t("5880");function j(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,s)}return t}function E(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?j(Object(t),!0).forEach((function(r){Object(a["a"])(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var I={data:function(){return{type:1,register_error:"",modifypass_error:"",login_error:""}},components:{LoginForm:p,RegisterForm:_,ModifyPassForm:O},computed:{switchButtonStyle:function(){return 1===this.type?{margin:"0",float:"right"}:{margin:"10px 0 0 0 ",width:"100%"}},message:function(){return 1===this.type?"注册账号":"使用已有账号登录"}},methods:E(E({},Object(N["mapActions"])(["handleLogin","handleRegister"])),{},{handleSubmit:function(e){var r=this,t=e.userName,s=e.password;this.handleLogin({userName:t,password:s}).then((function(e){r.$router.push({name:r.$config.homeName})})).catch((function(e){r.$Message.error("登录失败!"),401===e.response.data.code?r.login_error="账号或密码错误":(console.log(e),r.login_error="用户未注册")}))},handleSubmitRegister:function(e){var r=this,t=e.userName,s=e.password,o=e.email,a=e.verifyCode,i={username:t,password:s,email:o,code:a};Object(g["r"])("put",i).then((function(e){r.$Message.success("注册成功！"),r.register_error="",r.type=1,console.log})).catch((function(e){402===e.response.data.code?r.register_error="验证码错误!":409===e.response.data.code?r.register_error="邮箱已注册!":r.register_error="用户名已被注册!"}))},handleSubmitForgetPass:function(e){var r=this,t=e.password,s=e.email,o=e.verifyCode,a={password:t,email:s,code:o};Object(g["v"])("put",a).then((function(e){r.$Message.success("修改密码成功！"),r.odifypass_error="",r.type=1})).catch((function(e){e.response.data.error_msg.search(/Invalid confirm code/)?r.modifypass_error="验证码错误!":r.modifypass_error="邮箱未注册!"}))}})},q=I,B=Object(m["a"])(q,s,o,!1,null,null,null);r["default"]=B.exports}}]);