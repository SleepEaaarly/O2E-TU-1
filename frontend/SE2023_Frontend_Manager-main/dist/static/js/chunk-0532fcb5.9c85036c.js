(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0532fcb5"],{"4bf1":function(e,t,a){},"88eb":function(e,t){e.exports={messages:{CN:{add:"添加",delete:"删除",save:"保存",cancel:"取消",edit:"编辑",deleteConfirm:"是否要删除此行？",newMember:"新增成员",table:{name:"成员姓名",number:"工号",department:"所属部门",operation:"操作"}},HK:{add:"添加",delete:"刪除",save:"保存",cancel:"取消",edit:"編輯",deleteConfirm:"是否要刪除此行？",newMember:"新增成員",table:{name:"成員姓名",number:"工號",department:"所屬部門",operation:"操作"}},US:{add:"add",delete:"delete",save:"save",cancel:"cancel",edit:"edit",deleteConfirm:"Confirm to delete this row?",newMember:"new member",table:{name:"Member Name",number:"Job Number",department:"Department",operation:"Operation"}}}}},"97e9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("h2",[e._v("选择用户类型")]),a("a-space",[a("a-select",{ref:"select",staticStyle:{width:"120px"},attrs:{disabled:!e.changeable},on:{change:e.selectChange},model:{value:e.selectedType,callback:function(t){e.selectedType=t},expression:"selectedType"}},[a("a-select-option",{attrs:{value:"0"}},[e._v("普通用户")]),a("a-select-option",{attrs:{value:"1"}},[e._v("专家认证中")]),a("a-select-option",{attrs:{value:"2"}},[e._v("企业认证中")]),a("a-select-option",{attrs:{value:"3"}},[e._v("封禁中")]),a("a-select-option",{attrs:{value:"4"}},[e._v("认证专家")]),a("a-select-option",{attrs:{value:"5"}},[e._v("认证企业")]),a("a-select-option",{attrs:{value:"6"}},[e._v("全部")])],1),a("a-input-search",{staticStyle:{width:"300px","margin-left":"10px"},attrs:{placeholder:"请输入用户名","enter-button":""},on:{search:function(t){return e.onSearch()}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),a("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.adminCreateUser()}}},[e._v(" 添加普通用户 ")]),a("a-modal",{attrs:{title:"添加普通用户",footer:null},model:{value:e.user_visible,callback:function(t){e.user_visible=t},expression:"user_visible"}},[a("a-form",{attrs:{model:e.user_info,"label-col":{span:5},"wrapper-col":{span:12}}},[a("a-form-item",{attrs:{label:"用户名"}},[a("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.user_info.username,callback:function(t){e.$set(e.user_info,"username",t)},expression:"user_info.username"}})],1),a("a-form-item",{attrs:{label:"密码"}},[a("a-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.user_info.password,callback:function(t){e.$set(e.user_info,"password",t)},expression:"user_info.password"}})],1),a("a-form-item",{attrs:{label:"邮箱"}},[a("a-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.user_info.email,callback:function(t){e.$set(e.user_info,"email",t)},expression:"user_info.email"}})],1),a("a-form-item",{staticStyle:{"text-align":"right"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(" 确定 ")])],1)],1)],1),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.adminCreateExpert()}}},[e._v(" 添加专家 ")]),a("a-modal",{attrs:{title:"添加专家",footer:null},model:{value:e.expert_visible,callback:function(t){e.expert_visible=t},expression:"expert_visible"}},[a("a-form",{attrs:{form:e.expert_info,"label-col":{span:5},"wrapper-col":{span:12}},on:{submit:e.handleSubmit}},[a("a-form-item",{attrs:{label:"用户名"}},[a("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.expert_info.username,callback:function(t){e.$set(e.expert_info,"username",t)},expression:"expert_info.username"}})],1),a("a-form-item",{attrs:{label:"密码"}},[a("a-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.expert_info.password,callback:function(t){e.$set(e.expert_info,"password",t)},expression:"expert_info.password"}})],1),a("a-form-item",{attrs:{label:"邮箱"}},[a("a-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.expert_info.email,callback:function(t){e.$set(e.expert_info,"email",t)},expression:"expert_info.email"}})],1),a("a-form-item",{attrs:{label:"专家实名"}},[a("a-input",{attrs:{placeholder:"请输入专家实名"},model:{value:e.expert_info.name,callback:function(t){e.$set(e.expert_info,"name",t)},expression:"expert_info.name"}})],1),a("a-form-item",{attrs:{label:"机构"}},[a("a-input",{attrs:{placeholder:"请输入机构"},model:{value:e.expert_info.organization,callback:function(t){e.$set(e.expert_info,"organization",t)},expression:"expert_info.organization"}})],1),a("a-form-item",{attrs:{label:"身份证号"}},[a("a-input",{attrs:{placeholder:"请输入身份证号"},model:{value:e.expert_info.ID_num,callback:function(t){e.$set(e.expert_info,"ID_num",t)},expression:"expert_info.ID_num"}})],1),a("a-form-item",{staticStyle:{"text-align":"right"}},[a("a-button",{staticStyle:{"margin-left":"50%"},attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(" 确定 ")])],1)],1)],1),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.adminCreateCompany()}}},[e._v(" 添加企业 ")]),a("a-modal",{attrs:{title:"添加企业",footer:null},model:{value:e.company_visible,callback:function(t){e.company_visible=t},expression:"company_visible"}},[a("a-form",{attrs:{form:e.company_info,"label-col":{span:5},"wrapper-col":{span:12}},on:{submit:e.handleSubmit}},[a("a-form-item",{attrs:{label:"用户名"}},[a("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.company_info.username,callback:function(t){e.$set(e.company_info,"username",t)},expression:"company_info.username"}})],1),a("a-form-item",{attrs:{label:"密码"}},[a("a-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.company_info.password,callback:function(t){e.$set(e.company_info,"password",t)},expression:"company_info.password"}})],1),a("a-form-item",{attrs:{label:"邮箱"}},[a("a-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.company_info.email,callback:function(t){e.$set(e.company_info,"email",t)},expression:"company_info.email"}})],1),a("a-form-item",{attrs:{label:"企业名称"}},[a("a-input",{attrs:{placeholder:"请输入企业名称"},model:{value:e.company_info.name,callback:function(t){e.$set(e.company_info,"name",t)},expression:"company_info.name"}})],1),a("a-form-item",{attrs:{label:"企业所在地"}},[a("a-input",{attrs:{placeholder:"请输入企业所在地"},model:{value:e.company_info.address,callback:function(t){e.$set(e.company_info,"address",t)},expression:"company_info.address"}})],1),a("a-form-item",{staticStyle:{"text-align":"right"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(" 确定 ")])],1)],1)],1)],1),a("br"),a("br"),a("a-table",{key:e.itemKey,attrs:{"data-source":e.data,columns:e.columns,pagination:e.pagination},scopedSlots:e._u([e._l(["name","ins","email","type"],(function(t){return{key:t,fn:function(n,i){return[a("div",{key:t},[i.editable?a("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:n},on:{change:function(a){return e.handleChange(a.target.value,i,t)}}}):[e._v(" "+e._s(n)+" ")]],2)]}}})),{key:"operation",fn:function(t,n){return[a("div",{staticClass:"editable-row-operations"},[n.editable?a("span",[a("a-space",[a("a",{on:{click:function(){return e.save(n.key)}}},[e._v("Save")]),a("a-popconfirm",{attrs:{title:"Sure to cancel?"},on:{confirm:function(){return e.cancel(n.key)}}},[a("a",[e._v("Cancel")])])],1)],1):a("span",[a("a",{attrs:{disabled:""!==e.editingKey},on:{click:function(){return e.edit(n.key)}}},[e._v("Edit")])])]),e.data.length?a("a-popconfirm",{attrs:{title:"Sure to delete?"},on:{confirm:function(){return e.onDelete(n.key)}}},[a("a",{attrs:{href:"javascript:0;"}},[e._v("Ban")])]):e._e()]}}],null,!0)})],1)},i=[],r=a("2909"),o=a("c7eb"),s=a("1da1"),c=a("5530"),l=(a("d81d"),a("14d9"),a("4de4"),a("d3b7"),a("b0c0"),a("ac1f"),a("00b4"),a("ac8f")),u=[{title:"用户名",dataIndex:"name",width:"20%",scopedSlots:{customRender:"name"}},{title:"所属机构",dataIndex:"ins",width:"20%",scopedSlots:{customRender:"ins"}},{title:"邮箱",dataIndex:"email",width:"25%",scopedSlots:{customRender:"email"}},{title:"用户类型",dataIndex:"type",width:"15%",scopedSlots:{customRender:"type"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],d=[],p={name:"UserForm",inject:["reload"],i18n:a("88eb"),data:function(){var e=this;return this.cacheData=d.map((function(e){return Object(c["a"])({},e)})),{type:"",type1:0,data:d,columns:u,form:this.$form.createForm(this),user_info:{username:"",password:"",email:""},expert_info:{username:"",password:"",email:"",name:"",organization:"",ID_num:""},company_info:{username:"",password:"",email:"",name:"",address:""},company_visible:!1,expert_visible:!1,user_visible:!1,searchText:"",editingKey:"",editData:{},changeable:!0,selectedType:"全部",pagination:{current:1,onChange:function(t){if(e.changeable)if(e.$forceUpdate(),"搜索"==e.selectedType){var a={username:e.searchText,page:t};Object(l["u"])(a).then((function(a){var n=a.data;d.length=0;for(var i=0;i<n.data.length;i++)d.push({key:n.data[i].id,name:n.data[i].username,ins:n.data[i].institution,email:n.data[i].email,editable:!1});e.cacheData=d.map((function(e){return Object(c["a"])({},e)})),e.totalCnt=n.data.total_count,e.loading=!1,e.pagination.current=t})).catch((function(e){}))}else Object(l["n"])("全部"===e.selectedType?6:e.selectedType,t).then((function(a){var n=a.data;d.length=0;for(var i=0;i<n.data.length;i++)0==n.data[i].type?e.type="普通用户":1==n.data[i].type?e.type="专家认证中":2==n.data[i].type?e.type="企业认证中":3==n.data[i].type?e.type="封禁中":4==n.data[i].type?e.type="认证专家":5==n.data[i].type&&(e.type="认证企业"),d.push({key:n.data[i].id,name:n.data[i].username,ins:n.data[i].institution,type:e.type,email:n.data[i].email,editable:!1});e.cacheData=d.map((function(e){return Object(c["a"])({},e)})),e.totalCnt=n.data.total_count,e.loading=!1,e.pagination.current=t})).catch((function(e){}));else alert("请完成修改后再切换页面！")},total:10},itemKey:""}},watch:{editingKey:function(e){this.changeable=""===e}},mounted:function(){this.init()},methods:{init:function(){var e=Object(s["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.loadUser();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),loadUser:function(){var e=this;this.loading=!0,d.length=0,this.pagination.current=1,Object(l["n"])(6,1).then((function(t){for(var a=0;a<d.length;a++)d[a].target=!1;var n=t.data;d.length=0;for(var i=0;i<n.data.length;i++)0==n.data[i].type?e.type="普通用户":1==n.data[i].type?e.type="专家认证中":2==n.data[i].type?e.type="企业认证中":3==n.data[i].type?e.type="封禁中":4==n.data[i].type?e.type="认证专家":5==n.data[i].type&&(e.type="认证企业"),d.push({key:n.data[i].id,name:n.data[i].username,ins:n.data[i].institution,type:e.type,email:n.data[i].email});e.cacheData=d.map((function(e){return Object(c["a"])({},e)})),e.totalCnt=n.data.total_count,e.loading=!1,e.pagination.total=n.page_num})).catch((function(e){}))},onDelete:function(e){var t=this,a=Object(r["a"])(this.data);this.data=a.filter((function(t){return t.key!==e}));var n=a.filter((function(t){return e===t.key}))[0];"个人"==n.type?this.type1=0:"学校"==n.type?this.type1=1:this.type1=2;var i={id:n.key,name:n.name,usertype:this.type1,institution:n.ins,mail:n.email},o=this;Object(l["b"])(i).then((function(e){t.$message.info("成功删除")})).then((function(e){o.reload()})).catch((function(e){}))},handleChange:function(e,t,a){this.editData.key||(this.editData=t),"name"===a?this.editData.name=e:"ins"===a?this.editData.ins=e:"email"===a?this.editData.email=e:"type"===a&&(alert("暂不允许修改用户类型！！"),this.reload()),this.loadUser()},edit:function(e){var t=Object(r["a"])(this.data),a=t.filter((function(t){return e===t.key}))[0];this.editingKey=e,a&&(a.editable=!0,this.data=t)},save:function(e){var t=this,a=Object(r["a"])(this.data),n=Object(r["a"])(this.cacheData),i=a.filter((function(t){return e===t.key}))[0],o=n.filter((function(t){return e===t.key}))[0];i&&o&&(delete i.editable,this.data=a,Object.assign(o,i),this.cacheData=n),this.editingKey="","个人"==i.type?this.type1=0:"学校"==i.type?this.type1=1:this.type1=2;var s={id:this.editData.key,name:this.editData.name,institution:this.editData.ins,mail:this.editData.email},c=this;Object(l["c"])(s).then((function(e){501===e.data.code?alert(e.data.message):t.$message.info("成功修改")})).then((function(e){c.reload()})).catch((function(e){t.$message.error("无法修改"),alert("修改失败")})),i&&(Object.assign(i,this.cacheData.filter((function(t){return e===t.key}))[0]),delete i.editable,l["u"],this.data=a),this.reload(),this.loadUser()},cancel:function(e){var t=this,a=new Promise((function(a,n){var i=Object(r["a"])(t.data),o=i.filter((function(t){return e===t.key}))[0];t.editingKey="",o&&(Object.assign(o,t.cacheData.filter((function(t){return e===t.key}))[0]),delete o.editable,t.data=i),a()}));a.then(t.reload())},check_user_info:function(){if(this.user_visible){if(""==this.user_info.username||""==this.user_info.password||""==this.user_info.email)return alert("请填写完整信息"),!1}else{if(this.expert_visible){if(""==this.expert_info.username||""==this.expert_info.password||""==this.expert_info.email||""==this.expert_info.name||""==this.expert_info.organization||""==this.expert_info.ID_num)return alert("请填写完整信息"),!1;var e=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],t=[1,0,"X",9,8,7,6,5,4,3,2];if(/^\d{17}\d|x$/i.test(this.expert_info.ID_num)){for(var a,n=0,i=0;i<this.expert_info.ID_num.length-1;i++)n+=parseInt(this.expert_info.ID_num.substr(i,1),10)*e[i];return a=n%11,t[a]==this.expert_info.ID_num.substr(17,1).toUpperCase()||(alert("身份证格式有误"),!1)}return alert("身份证格式有误"),!1}if(this.company_visible&&(""==this.company_info.username||""==this.company_info.password||""==this.company_info.email||""==this.company_info.name||""==this.company_info.address))return alert("请填写完整信息"),!1}return!0},adminCreateUser:function(){this.user_visible=!0},adminCreateExpert:function(){this.expert_visible=!0},adminCreateCompany:function(){this.company_visible=!0},handleSubmit:function(){var e=this;this.check_user_info()&&(this.user_visible?Object(l["g"])(this.user_info).then((function(t){410==t.data.code?alert("用户名或邮箱已被注册"):501==t.data.code?alert(t.data.message):(e.resetUserInfo(),e.user_visible=!1)})).catch((function(e){})):this.expert_visible?Object(l["f"])(this.expert_info).then((function(t){410==t.data.code?alert("用户名或邮箱已被注册"):501==t.data.code?alert(t.data.message):(e.resetExpertInfo(),e.expert_visible=!1)})).catch((function(e){})):this.company_visible&&Object(l["e"])(this.company_info).then((function(t){410==t.data.code?alert("用户名或邮箱已被注册"):501==t.data.code?alert(t.data.message):(e.resetCompanyInfo(),e.company_visible=!1)})).catch((function(e){})))},resetUserInfo:function(){this.user_info={username:"",password:"",email:""}},resetExpertInfo:function(){this.expert_info={username:"",password:"",email:"",name:"",organization:"",ID_num:""}},resetCompanyInfo:function(){this.company_info={username:"",password:"",email:"",name:"",address:""}},onSearch:function(){var e=this;this.pagination.current=1;var t=encodeURIComponent(this.searchText),a={username:t,page:this.pagination.current};this.selectedType="搜索",Object(l["u"])(a).then((function(t){var a=t.data;d.length=0;for(var n=0;n<a.data.length;n++)d.push({key:a.data[n].id,name:a.data[n].username,ins:a.data[n].institution,email:a.data[n].email,editable:!1});e.totalCnt=a.page_num,e.loading=!1,e.pagination.total=10*a.page_num,e.itemKey=Math.random()})).catch((function(e){}))},selectChange:function(e){var t=this;this.changeable?(this.pagination.current=1,Object(l["n"])(this.selectedType,1).then((function(e){var a=e.data;d.length=0;for(var n=0;n<a.data.length;n++)0==a.data[n].type?t.type="普通用户":1==a.data[n].type?t.type="专家认证中":2==a.data[n].type?t.type="企业认证中":3==a.data[n].type?t.type="封禁中":4==a.data[n].type?t.type="认证专家":5==a.data[n].type&&(t.type="认证企业"),d.push({key:a.data[n].id,name:a.data[n].username,ins:a.data[n].institution,type:t.type,email:a.data[n].email,editable:!1});t.totalCnt=a.data.total_count,t.loading=!1,t.pagination.total=a.page_num,t.itemKey=Math.random()})).catch((function(e){}))):alert("请先完成编辑！")}}},f=p,m=(a("9d96"),a("2877")),h=Object(m["a"])(f,n,i,!1,null,"5f8c2bc6",null);t["default"]=h.exports},"9d96":function(e,t,a){"use strict";a("4bf1")},ac8f:function(e,t,a){"use strict";a.d(t,"q",(function(){return r})),a.d(t,"t",(function(){return o})),a.d(t,"s",(function(){return s})),a.d(t,"r",(function(){return c})),a.d(t,"k",(function(){return l})),a.d(t,"p",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"l",(function(){return p})),a.d(t,"m",(function(){return f})),a.d(t,"d",(function(){return m})),a.d(t,"i",(function(){return h})),a.d(t,"h",(function(){return _})),a.d(t,"j",(function(){return b})),a.d(t,"o",(function(){return y})),a.d(t,"n",(function(){return v})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return x})),a.d(t,"u",(function(){return k})),a.d(t,"g",(function(){return O})),a.d(t,"f",(function(){return j})),a.d(t,"e",(function(){return S}));a("c7eb"),a("1da1"),a("99af");var n=a("7424"),i=a("b775");var r=function(e){var t="Interpretation",a=n["BASE_URL_IP"]+"/api/".concat(t,"/getkeywords");return Object(i["f"])(a,"get",e)},o=function(e){var t=n["BASE_URL_IP"]+"/api/recommend";return Object(i["f"])(t,"get",e)},s=function(e){var t="Interpretation",a=n["BASE_URL_IP"]+"/api/".concat(t,"/getvis");return Object(i["f"])(a,"get",e)},c=function(e){var t="Interpretation",a=n["BASE_URL_IP"]+"/api/".concat(t,"/gettags");return Object(i["f"])(a,"get",e)},l=function(e,t){var a=n["BASE_URL_IP"]+"/api/comment";return Object(i["f"])(a,e,t)},u=function(e){var t=n["BASE_URL_IP"]+"/api/user/profile";return e?Object(i["f"])(t,"get",{user_id:e}):Object(i["f"])(t,"get")},d=function(e,t,a,r){var o=1===t?"Interpretation":"Note",s=n["BASE_URL_IP"]+"/api/".concat(o,"/").concat(e);return Object(i["f"])(s,a,r)},p=function(e){if(null===e||void 0===e)return"无";var t=new Date(e),a=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds(),n=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),i=t.getHours()<10?"0"+t.getHours():t.getHours();return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate()," ").concat(i,":").concat(n,":").concat(a)},f=function(e){return e?Object(i["f"])(n["PaperAll"],"get",{user_id:e}):Object(i["f"])(n["PaperAll"],"get")},m=function(e,t){var a=n["BASE_URL_IP"]+"/api/comment/create";return Object(i["f"])(a,e,t)},h=function(e,t){var a=n["BASE_URL_IP"]+"/api/comment/delete";return Object(i["f"])(a,e,t)},_=function(e){var t=n["BASE_URL_IP"]+"/api/discussion/create";return Object(i["f"])(t,"post",e)},b=function(e,t){var a=n["BASE_URL_IP"]+"/api/discussion/delete";return Object(i["f"])(a,e,t)},y=function(e){return e?Object(i["f"])(n["UserAll"],"get",{user_id:e}):Object(i["f"])(n["UserAll"],"get")},v=function(e,t){var a=n["BASE_URL_IP"]+"/api/user/".concat(e,"/all/").concat(t);return Object(i["f"])(a,"get")},g=function(e){var t=n["BASE_URL_IP"]+"/api/user/delete";return Object(i["f"])(t,"post",e)},x=function(e){var t=n["BASE_URL_IP"]+"/api/user/changeinfo";return Object(i["f"])(t,"post",e)},k=function(e){var t=n["BASE_URL_IP"]+"/api/admin/search/user";return Object(i["f"])(t,i["a"].POST,e)},O=function(e){var t=n["BASE_URL_IP"]+"/api/admin/add/user";return Object(i["f"])(t,i["a"].POST,e)},j=function(e){var t=n["BASE_URL_IP"]+"/api/admin/add/expert";return Object(i["f"])(t,i["a"].POST,e)},S=function(e){var t=n["BASE_URL_IP"]+"/api/admin/add/enterprise";return Object(i["f"])(t,i["a"].POST,e)}}}]);