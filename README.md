# O2E-TU-1

### [Bug fix log @ zry] 2023/05/25

**[安卓用户端]1.** 问题描述：点击清除缓存按钮以后，“我的”页面依旧留有AI/人工客服等按钮，并且可以点进去继续发消息，但发送的消息在重新登录以后看不到。
**[已修复 2023/05/25 07:08]** 在清空缓存时保留token（旧版本会因为access_token缺失导致大量接口缺少鉴权信息 401 Unauthorized)

**[安卓用户端]3.** 问题描述：在需求平台的发现页面，若输入带有“&”符号的关键字进行搜索，则无法搜正确的结果。
**[待修复 2023/05/25 07:16]** 搜索文本含特殊字符会影响字符串转义过程，前后端需要对此进行编码解码，除去需求检索，成果、专家、企业检索也需要做类似修改

预计前端使用encodeURIComponent编码：

```js
var text='search_keyword_text'
encode_text=encodeURIComponent(text)
```

调用API: 'need/search?key_word=' + encode_text

预计后端使用urllib.parse解码：

```python
from urllib import parse
text = parse.unquote(text)
```

**[安卓用户端]8.** 问题描述：申请专家认证页面，点击上传身份证按钮，选择拍摄会报错，如下图所示。
**[已修复 2023/05/25 07:29]** 修改app前端manifest.json，打包相机与相册模块

**[安卓用户端]9.** 问题描述：申请专家认证页面，没有对输入的身份证号进行合法性校验，比如身份证号输入“test667”也能成功申请。
**[已修复 2023/05/25 07:59]** 修改专家认证表单校验部分逻辑（旧版本键值名错误，对身份证图片文件使用身份证号验证规则）

**[安卓用户端]6.** 问题描述：登录页面输入错误的用户名或密码并点击登录没有提示
**[待修复 2023/05/25 08:03]** 后端登录接口（'token-auth'）应返回错误码'code'字段，对应前端代码如下：

```
let data = {}
data = await login({
	username: this.mobile,
	password: this.password
})
if('code' in data){
	if (data.code===401) {
		this.$http.toast('账号或密码错误')
	} else {
		this.$http.toast('用户未注册')
	}
	return
}
```

**[管理端]2.** 问题描述：在搜索用户页面，什么都不输入，直接点击搜索，可以搜出10个用户，但实际上用户有几百个。
**[待修复 2023/05/25 08:15]** 管理端搜索接口逻辑需要修改，用增加式搜索而非排除式搜索（APP用户端接口为默认持有所有数据，根据搜索关键字进行排除），管理端接口应修改为默认不持有数据，根据搜索关键词增加数据
